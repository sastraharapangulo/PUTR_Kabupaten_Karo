import{ca as Q}from"./index-D805BexR.js";import{a as D,b as R,g as Z}from"./Transformation2D-B_tst7So.js";import{N as w,aN as q,w as B,b as f,T as x,aO as b,aP as T,aQ as S,aR as U,aS as F,au as j,aT as H}from"./ProjectionTransformation-D1sWtOKI.js";import"./jsonConverter-H7Y8MF-2.js";import{t as J}from"./SimpleGeometryCursor-B92kdZ15.js";import{getSpatialReference as K,fromSpatialReference as L,fromPolyline as W,fromGeometry as X,toGeometry as Y}from"./apiConverter-B_LbrleL.js";var $=H;function g(l,e){return{m_geometry:l,m_side:e}}function tt(l,e,n,t,u,o){if(e.isEmpty()){const i=g(e,0);return void u.push(i)}if(n.isEmpty()){const i=g(e,0);return void u.push(i)}const s=[],r=new x;{const i=r.createGeometryUserIndex(),C=r.addGeometry(e),k=r.addGeometry(n),p=new U(o);let d=0,c=null;if(r.hasCurves()){c=new $;const h=r.getEnvelope2D(o);d=b(t.total());const _=T(t.total(),h);S(r,_,t.total(),12e3,c,null,o)}r.dbgVerifyCurves(),p.setEditShapeCrackAndCluster(r,t),p.cut(l,i,C,k,s);for(const h of s){c!==null&&c.stitchCurves(r,h,d,!1);const _=g(r.getGeometry(h),F(r.getGeometryUserIndex(h,i)));u.push(_)}c!==null&&c.clearStitcher(r)}}function et(l,e,n,t,u,o){if(e.isEmpty()){const i=g(e,0);return void u.push(i)}if(n.isEmpty()){const i=g(e,0);return void u.push(i)}const s=[],r=new x;{const i=r.createGeometryUserIndex(),C=r.addGeometry(e),k=r.addGeometry(n),p=new U(o);let d=0,c=null;if(r.hasCurves()){c=new $;const a=r.getEnvelope2D(o);d=b(t.total());const y=T(t.total(),a);S(r,y,t.total(),12e3,c,null,o)}r.dbgVerifyCurves(),p.setEditShapeCrackAndCluster(r,t),p.cut(!1,i,C,k,s),c!==null&&c.stitchCurves(r,j,d,!0);let h=r.getGeometry(C);const _=new f,E=new f,G=[];for(let a=0;a<s.length;a++){let y=null;{const m=new x,P=m.addGeometry(h),I=m.addGeometry(r.getGeometry(s[a]));if(m.hasCurves()){const A=m.getEnvelope2D(o);d=b(t.total());const V=T(t.total(),A);S(m,V,t.total(),12e3,c,null,o)}p.setEditShapeCrackAndCluster(m,t);const O=p.intersection(P,I);if(c!==null&&c.stitchCurves(m,j,d,!0),y=m.getGeometry(O),y.isEmpty())continue;const v=r.getGeometryUserIndex(s[a],i);v===2?_.add(y,!1):v===1?E.add(y,!1):G.push(y)}{const m=new x,P=m.addGeometry(h),I=m.addGeometry(r.getGeometry(s[a]));if(m.hasCurves()){const v=m.getEnvelope2D(o);d=b(t.total());const A=T(t.total(),v);S(m,A,t.total(),12e3,c,null,o)}p.setEditShapeCrackAndCluster(m,t);const O=p.difference(P,I);c!==null&&c.stitchCurves(m,j,d,!0),h=m.getGeometry(O)}}if(!h.isEmpty()&&s.length>0&&G.push(h),_.isEmpty()&&E.isEmpty())return;if(!_.isEmpty()){const a=g(_,1);u.push(a)}if(!E.isEmpty()){const a=g(E,2);u.push(a)}for(let a=0,y=G.length;a<y;++a){const m=g(G[a],3);u.push(m)}}}class st{getOperatorType(){return 10005}accelerateGeometry(e,n,t){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,n,t,u,o){return new rt(e,n,t,u,o)}}class rt extends J{constructor(e,n,t,u,o){super(),this.m_cutIndex=-1,this.m_cuts=[],this.m_progressTracker=o,this.m_cuttee=n.clone(),this.m_cutter=new w({copy:t}),this.m_bConsiderTouch=e;const s=q(n,t);this.m_tolerance=B(u,s,!0)}next(){return this.m_cutIndex===-1&&this.generateCuts(),++this.m_cutIndex<this.m_cuts.length?this.m_cuts[this.m_cutIndex]:null}getGeometryID(){return this.m_cutIndex}tock(){return!0}getRank(){return 1}generateCuts(){switch(this.m_cuttee.getGeometryType()){case D.enumPolyline:this.generatePolylineCuts();break;case D.enumPolygon:this.generatePolygonCuts()}}generatePolylineCuts(){const e=new w,n=new w,t=new w;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(n);const u=[];tt(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,u,this.m_progressTracker);for(let o=0;o<u.length;o++){const s=u[o];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2||s.m_side===4?n.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):R("")}t.isEmpty()||e.isEmpty()&&n.isEmpty()&&!(this.m_cuts.length>=3)||this.m_cuts.push(t),e.isEmpty()&&n.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}generatePolygonCuts(){const e=new f,n=new f,t=new f;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(n);const u=[];et(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,u,this.m_progressTracker);for(let o=0;o<u.length;o++){const s=u[o];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2?n.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):R("")}Z(t.isEmpty()||u.length===1),e.isEmpty()&&n.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}}const z=new st;function nt(l,e,n){const t=z.execute(!0,l,e,n,null);return Array.from(t)}function ot(){return z.supportsCurves()}function N(l,e){const n=K(l);return nt(X(l),W(e),L(n)).map(t=>Y(t,n)).filter(Q)}const M=ot(),ht=Object.freeze(Object.defineProperty({__proto__:null,execute:N,supportsCurves:M},Symbol.toStringTag,{value:"Module"})),pt=Object.freeze(Object.defineProperty({__proto__:null,execute:N,supportsCurves:M},Symbol.toStringTag,{value:"Module"}));export{pt as c,ht as i};

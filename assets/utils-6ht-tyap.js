const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/symbolLayerUtils-DIjxmTEa.js","assets/index-CdyqwYB1.js","assets/index-CxJz3tXl.css"])))=>i.map(i=>d[i]);
import{cX as w,be as a,d3 as h,hc as p,hd as d,he as g,hf as k,_ as L}from"./index-CdyqwYB1.js";import{C as z}from"./cimSymbolUtils-C7ZteOWC.js";new w(1e3);new a([128,128,128]);const j=new a("white");function J(n){if(n==null||!("symbolLayers"in n)||n.symbolLayers==null)return!1;switch(n.type){case"point-3d":return n.symbolLayers.some(r=>r.type==="object");case"line-3d":return n.symbolLayers.some(r=>r.type==="path");case"polygon-3d":return n.symbolLayers.some(r=>r.type==="object"||r.type==="extrude");default:return!1}}function N(n){var r;return((r=n.resource)==null?void 0:r.href)??""}function T(n,r){if(!n)return null;let t=null;return h(n)?t=x(n):p(n)&&(t=n.type==="cim"?z(n):n.color?new a(n.color):null),t?y(t,r):null}function x(n){const r=n.symbolLayers;if(!r)return null;let t=null;return r.forEach(l=>{var o;l.type==="object"&&((o=l.resource)!=null&&o.href)||(t=l.type==="water"?l.color:l.material?l.material.color:null)}),t?new a(t):null}function y(n,r){if(r==null||n==null)return n;const t=n.toRgba();return t[3]=t[3]*r,new a(t)}function _(n,r,t){const l=n.symbolLayers;if(!l)return;const o=e=>y(r=r??e??(t!=null?j:null),t);l.forEach(e=>{var c,s;if(e.type!=="object"||!((c=e.resource)!=null&&c.href)||r)if(e.type==="water")e.color=o(e.color);else{const i=e.material!=null?e.material.color:null,u=o(i);e.material==null?e.material=new d({color:u}):e.material.color=u,t!=null&&"outline"in e&&((s=e.outline)==null?void 0:s.color)!=null&&(e.outline.color=y(e.outline.color,t))}})}function v(n,r,t){var l;(r=r??n.color)&&(n.color=y(r,t)),t!=null&&"outline"in n&&((l=n.outline)!=null&&l.color)&&(n.outline.color=y(n.outline.color,t))}function U(n,r,t){n&&(r||t!=null)&&(r&&(r=new a(r)),h(n)?_(n,r,t):p(n)&&v(n,r,t))}async function S(n,r){const t=n.symbolLayers;t&&await g(t,async l=>E(l,r))}async function E(n,r){switch(n.type){case"extrude":R(n,r);break;case"icon":case"line":case"text":$(n,r);break;case"path":O(n,r);break;case"object":await C(n,r)}}function $(n,r){const t=m(r);t!=null&&(n.size=t)}function m(n){for(const r of n)if(typeof r=="number")return r;return null}function R(n,r){n.size=typeof r[2]=="number"?r[2]:0}async function C(n,r){const{resourceSize:t,symbolSize:l}=await D(n),o=b(r,t,l);n.width=f(r[0],l[0],t[0],o),n.depth=f(r[1],l[1],t[1],o),n.height=f(r[2],l[2],t[2],o)}function O(n,r){const t=b(r,k,[n.width,void 0,n.height]);n.width=f(r[0],n.width,1,t),n.height=f(r[2],n.height,1,t)}function b(n,r,t){for(let l=0;l<3;l++){const o=n[l];switch(o){case"symbol-value":{const e=t[l];return e!=null?e/r[l]:1}case"proportional":break;default:if(o&&r[l])return o/r[l]}}return 1}async function D(n){const{computeObjectLayerResourceSize:r}=await L(()=>import("./symbolLayerUtils-DIjxmTEa.js"),__vite__mapDeps([0,1,2])),t=await r(n,10),{width:l,height:o,depth:e}=n,c=[l,e,o];let s=1;for(let i=0;i<3;i++){const u=c[i];if(u!=null){s=u/t[i];break}}for(let i=0;i<3;i++)c[i]==null&&(c[i]=t[i]*s);return{resourceSize:t,symbolSize:c}}function f(n,r,t,l){switch(n){case"proportional":return t*l;case"symbol-value":return r??t;default:return n}}function P(n,r){const t=m(r);if(t!=null)switch(n.type){case"simple-marker":n.size=t;break;case"picture-marker":{const l=n.width/n.height;l>1?(n.width=t,n.height=t*l):(n.width=t*l,n.height=t);break}case"simple-line":n.width=t;break;case"text":n.font.size=t}}async function V(n,r){if(n&&r)return h(n)?S(n,r):void(p(n)&&P(n,r))}function X(n,r,t){if(n&&r!=null)if(h(n)){const l=n.symbolLayers;l&&l.forEach(o=>{if(o.type==="object")switch(t){case"tilt":o.tilt=(o.tilt??0)+r;break;case"roll":o.roll=(o.roll??0)+r;break;default:o.heading=(o.heading??0)+r}o.type==="icon"&&(o.angle+=r)})}else p(n)&&(n.type!=="simple-marker"&&n.type!=="picture-marker"&&n.type!=="text"||(n.angle+=r))}function q(n){return n!=null&&n.type==="polygon-3d"&&n.symbolLayers.some(r=>r.type==="extrude")}export{V as D,X as J,q as N,U as g,T as h,N as p,J as y};
